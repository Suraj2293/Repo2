import csv
import sys
import random
import time
import datetime
import socket
import StringIO
from kafka import KafkaProducer

#HOST, PORT = "localhost", 9191

# Create a socket (SOCK_STREAM means a TCP socket)
producer = KafkaProducer(bootstrap_servers='podadr1.podadr1.t3.internal.cloudapp.net:6667')


try:
    # writer = csv.writer(f)
    i = 0
    while True:

                categoryOutcome1=random.choice(["/Failure", "/Failure1"])
                reason1="attack"
                deviceEventCategory1="normal"
                categoryObject="/Host/Application/Service"
                cs4Label="PID"
                requestCookies1="coos1"
                deviceVersion="arcsight:10:17"
                destinationServiceName1="mail"
                ahost="ssiembmbbom1"
                adrCustomStr31="cu3"
                agt='.'.join('%s'%random.randint(0, 255) for i in range(4))
                dvc='.'.join('%s'%random.randint(0, 255) for i in range(4))
                deviceAction1="checking"
                deviceCustomString61="f"
                requestContext1="context"
                requestUrlFileName1="tm"
                destinationHostName1="ram"
                deviceAddress1='.'.join('%s'%random.randint(0, 255) for i in range(4))
                deviceHostName1="ravi"
                deviceCustomString21="b"
                cn1Label="File Descriptor"
                duser="siem_arcsight1"
                applicationProtocol1="smtp"
                baseEventCount1="5"
                requestCookie1="coo1"
                flexString11="a"
                deviceCustomNumber11="1"
                atz="Asia/Calcutta"
                categorySignificance="/Normal"
                categoryBehavior1="/Authentication/Verify"
                sourceNtDomain1="com"
                deviceDirection1="north"
                customerName="Bhartiya Mahila Bank"

		t1 = time.time()
                newt1=t1*1000
                deviceReceiptTime1=int(newt1)

                requestMethod1="get"
                adrCustomStr21="cu2"
                at="syslog"
                av="7.1.1.7348.0"
                deviceCustomString31="c"
                signatureID=""
                deviceVendor1="Unix"
                deviceFacility="authpriv" 
                eventId1=random.randint(1001, 1010)
                aid="3sgxTeUsBABCAA9AtbA0Ztw\=\="
                name1="suresh"
                adrCustomeNumber11="11"
                dhost="lrpwebbmbbom1"
                filePath1="/home"
                sourceHostName1="raju"
                cs1="sshd"
                _cefVer="0.1"

		t2 = time.time()
                newt2=t2*1000
                rt=int(newt2)

                deviceOutboundInterface1="i2"
                cs2="authpriv"
                deviceSeverity1="info"
                cs4="56297"
                catdt="Operating System"
                requestClientApplication1="app1"
                cs1Label="Module"
                destinationProcessName1="mail sending"
                destinationUserName1="ram"

		t3 = time.time()
                newt3=t3*1000
                endTime1=int(newt3)

                adrCustomStr11="cu1"
                dvchost="lrpwebbmbbom1"
                deviceCustomString41="d"
                deviceEventClassId1="c1"
                deviceProcessName="ssuhd"

		t4 = time.time()
                newt4=t4*1000
                startTime1=int(newt4)

                deviceCustomNumber21="2"
                requestUrl1="/url"
                destinationAddress1='.'.join('%s'%random.randint(0, 255) for i in range(4))
                destinationPort1="1234"
                art=random.randint(1477391764870, 1477391864870)
                deviceProduct1="Unix"
                customerURI1="/All Customers/Bhartiya Mahila Bank"
                bytesOut1="24"
                dtz="Asia/Calcutta"
                sourcePort1=random.randint(1, 60000)
                externalId1="1"
                sourceAddress1='.'.join('%s'%random.randint(0, 255) for i in range(4))
                deviceInboundInterface1="i1"
                transportProtocol1="smtp"
                adrCustomStr41="cu4"
                deviceCustomString51="e"
                fileName1="file1"
                categoryDeviceGroup="/Operating System"
                sourceUserName1="mike"
                deviceCustomNumber31="3"
                deviceCustomString11="a"
                cs2Label="Facility"
                bytesIn1="24"
                message1="hi"
                reason1="attack"
                categoryObject="/Host/Application/Service"
                cs4Label="PID"

               
                data = ",".join(["categoryOutcome1="+categoryOutcome1+",deviceEventCategory1="+deviceEventCategory1+",categoryObject="+categoryObject+",cs4Label="+cs4Label+",requestCookies1="+requestCookies1+",deviceVersion="+deviceVersion+",destinationServiceName1="+destinationServiceName1+",ahost="+ahost+",adrCustomStr31="+adrCustomStr31+",agt="+agt+",dvc="+dvc+",deviceAction1="+deviceAction1+",deviceCustomString61="+deviceCustomString61+",requestContext1="+requestContext1+",requestUrlFileName1="+requestUrlFileName1+",destinationHostName1="+destinationHostName1+",deviceAddress1="+deviceAddress1+",deviceHostName1="+deviceHostName1+",deviceCustomString21="+deviceCustomString21+",cn1Label="+cn1Label+",duser="+duser+",applicationProtocol1="+applicationProtocol1+",baseEventCount1="+baseEventCount1+",requestCookie1="+requestCookie1+",flexString11="+flexString11+",deviceCustomNumber11="+deviceCustomNumber11+",atz="+atz+",categorySignificance="+categorySignificance+",categoryBehavior1="+categoryBehavior1+",sourceNtDomain1="+sourceNtDomain1+",deviceDirection1="+deviceDirection1+",customerName="+customerName+",deviceReceiptTime1="+str(deviceReceiptTime1)+",requestMethod1="+requestMethod1+",adrCustomStr21="+adrCustomStr21+",at="+at+",av="+av+",deviceCustomString31="+deviceCustomString31+",Signature ID="+str(signatureID)+",deviceVendor1="+deviceVendor1+",deviceFacility="+deviceFacility+",eventId1="+str(eventId1)+",aid="+aid+",name1="+name1+",adrCustomeNumber11="+str(adrCustomeNumber11)+",dhost="+dhost+",filePath1="+filePath1+",sourceHostName1="+sourceHostName1+",cs1="+cs1+",_cefVer="+_cefVer+",rt="+str(rt)+",deviceOutboundInterface1="+deviceOutboundInterface1+",cs2="+cs2+",deviceSeverity1="+deviceSeverity1+",cs4="+cs4+",catdt="+catdt+",requestClientApplication1="+requestClientApplication1+",cs1Label="+cs1Label+",destinationProcessName1="+destinationProcessName1+",destinationUserName1="+destinationUserName1+",endTime1="+str(endTime1)+",adrCustomStr11="+adrCustomStr11+",dvchost="+dvchost+",deviceCustomString41="+deviceCustomString41+",deviceCustomString51="+deviceCustomString51+",deviceCustomString11="+deviceCustomString11+",deviceEventClassId1="+deviceEventClassId1+",deviceProcessName="+deviceProcessName+",startTime1="+str(startTime1)+",deviceCustomNumber21="+deviceCustomNumber21+",deviceCustomNumber31="+deviceCustomNumber31+",requestUrl1="+requestUrl1+",destinationAddress1="+str(destinationAddress1)+",destinationPort1="+str(destinationPort1)+",art="+str(art)+",deviceProduct1="+deviceProduct1+",customerURI1="+customerURI1+",bytesOut1="+str(bytesOut1)+",dtz="+dtz+",sourcePort1="+str(sourcePort1)+",externalId1="+str(externalId1)+",sourceAddress1="+str(sourceAddress1)+",deviceInboundInterface1="+deviceInboundInterface1+",fileName1="+fileName1+",categoryDeviceGroup="+categoryDeviceGroup+",sourceUserName1="+sourceUserName1+",bytesIn1="+str(bytesIn1)+",msg="+message1+",reason1="+reason1+",transportProtocol1="+transportProtocol1])

                # data = ",".join([ str(eventTime), str(receiptTime), device, logger, version,
                #                 deviceVendor, deviceProduct, deviceVersion, deviceEventClassId,agentSeverity, 
                #                 cefVer, customerURI, deviceCustomString1, agentId, rawMessage, 
                #                 deviceCustomString1Label, deviceProcessName, eventId, str(sourceAddress), deviceCustomString3Label,
                #                 str(endTime),customerName, str(baseEventCount), deviceAddress, deviceTimeZone,
                #                 deviceHostName, str(agentReceiptTime),agentType, agentVersion, agentTimeZone, 
                #                 str(startTime), str(deviceReceiptTime), agentAddress, agentHostName, deviceCustomString2Label,
                #                 categoryBehavior, catdt,deviceFacility, categoryDeviceGroup, message, 
                #                 deviceCustomString4, deviceCustomString2, categoryTechnique,deviceCustomNumber1Label, categoryObject,
                #                 categorySignificance, categoryOutcome, str(destinationAddress),str(sourcePort),destinationZoneURI])
     

                
                producer.send('multievent_multipart',(data + "\n").encode())
                #print(data)
                i = i + 1
                time.sleep(0.00098)
finally:
		print ' '
